<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synthetic Note Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Synthetic Note Generator</h1>
        
        <!-- Note Type Section -->
        <section id="noteTypeSection">
            <h2>Note Type</h2>
            <div class="input-group">
                <label>Note Generation Type:</label>
                <select id="noteGenerationType">
                    <option value="single">Single Note</option>
                    <option value="treatment_period">Treatment Period</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>Clinical Note Type:</label>
                <select id="clinicalNoteType">
                    <option value="initial">Initial Consultation</option>
                    <option value="followup">Follow-up</option>
                    <option value="treatment">On-treatment Visit</option>
                    <option value="summary">Treatment Summary</option>
                </select>
            </div>
        </section>

        <!-- Patient Demographics Section -->
        <section id="demographicsSection">
            <h2>Patient Demographics</h2>
            <div class="input-group">
                <label>Age:</label>
                <input type="number" id="patientAge" min="18" max="100">
            </div>
            <div class="input-group">
                <label>Sex:</label>
                <select id="patientSex">
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
            </div>
            <div class="input-group">
                <label>Race:</label>
                <select id="patientRace">
                    <option value="white">White</option>
                    <option value="black">Black</option>
                    <option value="asian">Asian</option>
                    <option value="native">Native American</option>
                </select>
            </div>
            <div class="input-group">
                <label>First Name:</label>
                <input type="text" id="firstName">
            </div>
            <div class="input-group">
                <label>Last Name:</label>
                <input type="text" id="lastName">
            </div>
        </section>

        <!-- Medical Values Section -->
        <section id="medicalSection">
            <h2>Medical Values</h2>
            <div class="input-group">
                <label>AUA Value:</label>
                <input type="number" id="aua" min="0" max="35">
            </div>
            <div class="input-group">
                <label>IPSS Value:</label>
                <input type="number" id="ipss" min="0" max="35">
            </div>
            <div class="input-group">
                <label>SHIM Value:</label>
                <input type="number" id="shim" min="1" max="25">
            </div>
            <div class="input-group">
                <label>ECOG Value:</label>
                <input type="number" id="ecog" min="0" max="4">
            </div>
            <div class="input-group">
                <label>PSA Score:</label>
                <input type="number" id="psaScore" step="0.01" min="0">
            </div>
            <div class="input-group">
                <label>Disease Site:</label>
                <select id="diseaseSite">
                    <option value="prostate">Prostate</option>
                    <option value="lung">Lung</option>
                </select>
            </div>
            <div class="input-group">
                <label>Risk Level:</label>
                <select id="riskLevel">
                    <option value="low">Low</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="high">High</option>
                </select>
            </div>
            <div class="input-group">
                <label>Gleason Score Primary:</label>
                <input type="number" id="gleasonPrimary" min="3" max="5">
            </div>
            <div class="input-group">
                <label>Gleason Score Secondary:</label>
                <input type="number" id="gleasonSecondary" min="3" max="5">
            </div>
        </section>

        <!-- Clinical Sections Toggle -->
        <section id="sectionsToggle">
            <h2>Include Sections</h2>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="includeHPI" checked> History of Present Illness
                </label>
                <label>
                    <input type="checkbox" id="includeVitals" checked> Vitals
                </label>
                <label>
                    <input type="checkbox" id="includeSocial" checked> Social History
                </label>
                <label>
                    <input type="checkbox" id="includeMedical" checked> Medical List
                </label>
                <label>
                    <input type="checkbox" id="includeExam" checked> Physical Exam
                </label>
                <label>
                    <input type="checkbox" id="includeImaging" checked> Imaging Results
                </label>
                <label>
                    <input type="checkbox" id="includePlan" checked> Treatment Plan
                </label>
            </div>
        </section>

        <!-- Regenerate text -->
        <div>
            <input type="checkbox" id="regenerateAssessmentPlan">
            <label for="regenerateAssessmentPlan">Regenerate assessment plan?</label>
        </div>
        <div>
            <input type="checkbox" id="regenerateHPI">
            <label for="regenerateHPI">Regenerate HPI?</label>
        </div>

        <button id="generateNote">Generate Note</button>

        <div id="noteOutput"></div>
    </div>

    <script>
        document.getElementById('generateNote').addEventListener('click', function() {
            // Collect all form data
            const formData = {
                noteType: {
                    generation: document.getElementById('noteGenerationType').value,
                    clinical: document.getElementById('clinicalNoteType').value
                },
                demographics: {
                    age: document.getElementById('patientAge').value,
                    sex: document.getElementById('patientSex').value,
                    race: document.getElementById('patientRace').value,
                    firstName: document.getElementById('firstName').value,
                    lastName: document.getElementById('lastName').value
                },
                medicalValues: {
                    aua: document.getElementById('aua').value,
                    ipss: document.getElementById('ipss').value,
                    shim: document.getElementById('shim').value,
                    ecog: document.getElementById('ecog').value,
                    psaScore: document.getElementById('psaScore').value,
                    diseaseSite: document.getElementById('diseaseSite').value,
                    riskLevel: document.getElementById('riskLevel').value,
                    gleasonPrimary: document.getElementById('gleasonPrimary').value,
                    gleasonSecondary: document.getElementById('gleasonSecondary').value
                },
                includeSections: {
                    hpi: document.getElementById('includeHPI').checked,
                    vitals: document.getElementById('includeVitals').checked,
                    social: document.getElementById('includeSocial').checked,
                    medical: document.getElementById('includeMedical').checked,
                    exam: document.getElementById('includeExam').checked,
                    imaging: document.getElementById('includeImaging').checked,
                    plan: document.getElementById('includePlan').checked,
                },
                regenSections: {
                    regenerate_hpi: document.getElementById('regenerateHPI').checked,
                    regenerate_assmplan: document.getElementById('regenerateAssessmentPlan').checked
                }
            };

            // Send data to backend
            fetch('/generate_note', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    document.getElementById('noteOutput').innerHTML = `
                        <h2>Error:</h2>
                        <pre>${data.error}</pre>
                        <h2>Stack Trace:</h2>
                        <pre>${data.trace}</pre>
                    `;
                } else {
                    document.getElementById('noteOutput').innerHTML = `
                        <h2>Generated Note:</h2>
                        <pre>${data.text}</pre>
                        <h2>Note Data:</h2>
                        <pre>${JSON.stringify(data.data, null, 2)}</pre>
                    `;
                }
            });
        });
    </script>
</body>
</html>
